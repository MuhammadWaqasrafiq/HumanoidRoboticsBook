"use strict";(self.webpackChunkphysical_ai_humanoid_robotics_book=self.webpackChunkphysical_ai_humanoid_robotics_book||[]).push([[4677],{2582:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"ros2-fundamentals/services-actions","title":"Section 2 - Services & Actions","description":"Request-response communication and long-running tasks in ROS 2","source":"@site/docs/ros2-fundamentals/services-actions.mdx","sourceDirName":"ros2-fundamentals","slug":"/ros2-fundamentals/services-actions","permalink":"/HumanoidRoboticsBook/docs/ros2-fundamentals/services-actions","draft":false,"unlisted":false,"editUrl":"https://github.com/MuhammadWaqasrafiq/HumanoidRoboticsBook/tree/main/docs/ros2-fundamentals/services-actions.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"id":"services-actions","title":"Section 2 - Services & Actions","sidebar_position":2,"description":"Request-response communication and long-running tasks in ROS 2","keywords":["ros2-services","ros2-actions","request-response","goal-feedback-result","rclpy"]},"sidebar":"tutorialSidebar","previous":{"title":"Nodes & Topics","permalink":"/HumanoidRoboticsBook/docs/ros2-fundamentals/nodes-topics"},"next":{"title":"Parameters & Launch Files","permalink":"/HumanoidRoboticsBook/docs/ros2-fundamentals/parameters-launch"}}');var i=s(4848),t=s(8453);const c={id:"services-actions",title:"Section 2 - Services & Actions",sidebar_position:2,description:"Request-response communication and long-running tasks in ROS 2",keywords:["ros2-services","ros2-actions","request-response","goal-feedback-result","rclpy"]},l="Section 2: Services & Actions",o={},a=[{value:"Introduction",id:"introduction",level:2},{value:"What is a Service?",id:"what-is-a-service",level:2},{value:"Service vs Topic",id:"service-vs-topic",level:3},{value:"Service Communication Flow",id:"service-communication-flow",level:2},{value:"Service Server Example",id:"service-server-example",level:2},{value:"Service Client Example",id:"service-client-example",level:2},{value:"Service Introspection with CLI",id:"service-introspection-with-cli",level:2},{value:"What is an Action?",id:"what-is-an-action",level:2},{value:"Action vs Service",id:"action-vs-service",level:3},{value:"Action Communication Flow",id:"action-communication-flow",level:2},{value:"Action Server Example",id:"action-server-example",level:2},{value:"Action Client Example",id:"action-client-example",level:2},{value:"Action Introspection with CLI",id:"action-introspection-with-cli",level:2},{value:"When to Use Topics, Services, or Actions?",id:"when-to-use-topics-services-or-actions",level:2},{value:"Decision Matrix",id:"decision-matrix",level:3},{value:"Practical Example: Robot Delivery System",id:"practical-example-robot-delivery-system",level:2},{value:"Common Pitfalls and Solutions",id:"common-pitfalls-and-solutions",level:2},{value:"1. &quot;Service call times out&quot;",id:"1-service-call-times-out",level:3},{value:"2. &quot;Action feedback not received&quot;",id:"2-action-feedback-not-received",level:3},{value:"3. &quot;Service response is None&quot;",id:"3-service-response-is-none",level:3},{value:"4. &quot;Action goal immediately rejected&quot;",id:"4-action-goal-immediately-rejected",level:3},{value:"Key Takeaways",id:"key-takeaways",level:2},{value:"Exercises",id:"exercises",level:2},{value:"Next Section",id:"next-section",level:2},{value:"Further Reading",id:"further-reading",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"section-2-services--actions",children:"Section 2: Services & Actions"})}),"\n",(0,i.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsxs)(n.p,{children:["While ",(0,i.jsx)(n.strong,{children:"topics"})," are ideal for continuous data streams (sensor readings, velocity commands), robotics applications also need:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Request-response interactions"}),': "Calculate inverse kinematics for this pose"']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Long-running tasks with feedback"}),': "Navigate to waypoint X, report progress every second"']}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"ROS 2 provides two additional communication patterns:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Services"}),": Synchronous request-response (client waits for server's answer)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Actions"}),": Asynchronous goal-based tasks with feedback and cancellation"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"what-is-a-service",children:"What is a Service?"}),"\n",(0,i.jsxs)(n.p,{children:["A ",(0,i.jsx)(n.strong,{children:"service"})," is a one-to-one communication pattern where:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Client"})," sends a request and blocks until response arrives"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Server"})," processes the request and sends back a response"]}),"\n",(0,i.jsxs)(n.li,{children:["Communication is ",(0,i.jsx)(n.strong,{children:"synchronous"}),": Client waits for the result"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Analogy"}),": Services are like function calls over a network:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Local function call\nresult = calculate_inverse_kinematics(target_pose)\n\n# ROS 2 service call (same conceptual flow)\nresult = client.call(request)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"service-vs-topic",children:"Service vs Topic"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Feature"}),(0,i.jsx)(n.th,{children:"Topic (Pub-Sub)"}),(0,i.jsx)(n.th,{children:"Service (Request-Response)"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Communication"})}),(0,i.jsx)(n.td,{children:"One-to-many (broadcast)"}),(0,i.jsx)(n.td,{children:"One-to-one (direct)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Synchronicity"})}),(0,i.jsx)(n.td,{children:"Asynchronous (fire-and-forget)"}),(0,i.jsx)(n.td,{children:"Synchronous (waits for response)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Frequency"})}),(0,i.jsx)(n.td,{children:"Continuous streaming"}),(0,i.jsx)(n.td,{children:"On-demand"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Use case"})}),(0,i.jsx)(n.td,{children:"Sensor data, commands"}),(0,i.jsx)(n.td,{children:"Computation, queries"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Example"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"/cmd_vel"})," (velocity)"]}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"/calculate_ik"})," (kinematics)"]})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"service-communication-flow",children:"Service Communication Flow"}),"\n",(0,i.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant C as Client Node\n    participant S as Service (/add_two_ints)\n    participant SN as Server Node\n\n    Note over C: Need to add 5 + 3\n    C->>S: Request (a=5, b=3)\n    S->>SN: Forward request\n    Note over SN: Process: 5 + 3 = 8\n    SN->>S: Response (sum=8)\n    S->>C: Response (sum=8)\n    Note over C: Received result: 8\n\n    Note over C,SN: Synchronous: Client blocks until response"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Key properties"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Blocking"}),": Client waits for response (or timeout)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Reliable"}),": Uses TCP-like transport (RELIABLE QoS)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Stateless"}),": Each request is independent"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Typed"}),": Request and response have defined message types"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"service-server-example",children:"Service Server Example"}),"\n",(0,i.jsx)(n.p,{children:"Let's create a simple service that adds two integers:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# File: add_two_ints_server.py\nimport rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\n\n\nclass AddTwoIntsServer(Node):\n    def __init__(self):\n        super().__init__('add_two_ints_server')\n\n        # Create service: service type, service name, callback function\n        self.srv = self.create_service(\n            AddTwoInts,\n            'add_two_ints',\n            self.add_two_ints_callback\n        )\n\n        self.get_logger().info('Add Two Ints Server started!')\n\n    def add_two_ints_callback(self, request, response):\n        \"\"\"Called when a client sends a request.\"\"\"\n        response.sum = request.a + request.b\n        self.get_logger().info(f'Incoming request: {request.a} + {request.b}')\n        self.get_logger().info(f'Sending response: {response.sum}')\n        return response\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = AddTwoIntsServer()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Breakdown"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"create_service(service_type, service_name, callback)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"AddTwoInts"})," - Service type from ",(0,i.jsx)(n.code,{children:"example_interfaces.srv"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"'add_two_ints'"})," - Service name (by convention, no leading ",(0,i.jsx)(n.code,{children:"/"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"add_two_ints_callback"})," - Function that processes requests"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Callback signature"}),": ",(0,i.jsx)(n.code,{children:"def callback(self, request, response)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"request"})," - Input from client (has fields ",(0,i.jsx)(n.code,{children:"a"}),", ",(0,i.jsx)(n.code,{children:"b"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"response"})," - Output to client (has field ",(0,i.jsx)(n.code,{children:"sum"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Must return"})," ",(0,i.jsx)(n.code,{children:"response"})," object"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Running the server"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Terminal 1: Start the service server\nsource /opt/ros/jazzy/setup.bash\npython3 add_two_ints_server.py\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"service-client-example",children:"Service Client Example"}),"\n",(0,i.jsx)(n.p,{children:"Now create a client that calls the service:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# File: add_two_ints_client.py\nimport sys\nimport rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\n\n\nclass AddTwoIntsClient(Node):\n    def __init__(self):\n        super().__init__('add_two_ints_client')\n\n        # Create client: service type, service name\n        self.client = self.create_client(AddTwoInts, 'add_two_ints')\n\n        # Wait for service to be available\n        while not self.client.wait_for_service(timeout_sec=1.0):\n            self.get_logger().info('Service not available, waiting...')\n\n        self.get_logger().info('Connected to service!')\n\n    def send_request(self, a, b):\n        \"\"\"Send a request and wait for response.\"\"\"\n        request = AddTwoInts.Request()\n        request.a = a\n        request.b = b\n\n        self.get_logger().info(f'Sending request: {a} + {b}')\n\n        # Call service (blocks until response or timeout)\n        future = self.client.call_async(request)\n        rclpy.spin_until_future_complete(self, future)\n\n        if future.result() is not None:\n            response = future.result()\n            self.get_logger().info(f'Result: {a} + {b} = {response.sum}')\n            return response.sum\n        else:\n            self.get_logger().error('Service call failed!')\n            return None\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    if len(sys.argv) != 3:\n        print('Usage: python3 add_two_ints_client.py <a> <b>')\n        return\n\n    node = AddTwoIntsClient()\n\n    a = int(sys.argv[1])\n    b = int(sys.argv[2])\n\n    result = node.send_request(a, b)\n\n    node.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Breakdown"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"create_client(service_type, service_name)"})," - Creates client proxy"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"wait_for_service(timeout_sec)"})," - Blocks until server is available"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"call_async(request)"})," - Sends request, returns ",(0,i.jsx)(n.code,{children:"Future"})," object"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"spin_until_future_complete()"})," - Waits for response to arrive"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Running the client"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Terminal 2: Call the service\nsource /opt/ros/jazzy/setup.bash\npython3 add_two_ints_client.py 5 3\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Expected output"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[INFO] [add_two_ints_client]: Connected to service!\n[INFO] [add_two_ints_client]: Sending request: 5 + 3\n[INFO] [add_two_ints_client]: Result: 5 + 3 = 8\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"service-introspection-with-cli",children:"Service Introspection with CLI"}),"\n",(0,i.jsx)(n.p,{children:"While services are running, use these commands:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# List all active services\nros2 service list\n# Output:\n# /add_two_ints\n# /node_name/describe_parameters\n# /node_name/get_parameters\n# ...\n\n# Show service type\nros2 service type /add_two_ints\n# Output: example_interfaces/srv/AddTwoInts\n\n# Call service from command line\nros2 service call /add_two_ints example_interfaces/srv/AddTwoInts "{a: 10, b: 20}"\n# Output: sum: 30\n\n# View service definition\nros2 interface show example_interfaces/srv/AddTwoInts\n# Output:\n# int64 a\n# int64 b\n# ---\n# int64 sum\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsxs)(n.strong,{children:["Note the ",(0,i.jsx)(n.code,{children:"---"})," separator"]}),": Above the line is the ",(0,i.jsx)(n.strong,{children:"request"}),", below is the ",(0,i.jsx)(n.strong,{children:"response"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"what-is-an-action",children:"What is an Action?"}),"\n",(0,i.jsxs)(n.p,{children:["An ",(0,i.jsx)(n.strong,{children:"action"})," is a communication pattern for ",(0,i.jsx)(n.strong,{children:"long-running tasks"})," that need:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Goal"}),': Start a task (e.g., "Navigate to waypoint X")']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Feedback"}),': Periodic progress updates (e.g., "50% complete, 10 meters remaining")']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Result"}),': Final outcome (e.g., "Reached target successfully")']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Cancellation"}),": Ability to abort mid-execution"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Analogy"}),": Actions are like async jobs with progress bars:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'# Start async job\njob = start_navigation(target_waypoint)\n\n# Check progress periodically\nwhile not job.done():\n    print(f"Progress: {job.get_progress()}%")\n\n# Get final result\nresult = job.get_result()\n'})}),"\n",(0,i.jsx)(n.h3,{id:"action-vs-service",children:"Action vs Service"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Feature"}),(0,i.jsx)(n.th,{children:"Service"}),(0,i.jsx)(n.th,{children:"Action"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Duration"})}),(0,i.jsx)(n.td,{children:"Instant (under 1 second)"}),(0,i.jsx)(n.td,{children:"Long-running (seconds to minutes)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Feedback"})}),(0,i.jsx)(n.td,{children:"None"}),(0,i.jsx)(n.td,{children:"Periodic progress updates"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Cancellation"})}),(0,i.jsx)(n.td,{children:"Not supported"}),(0,i.jsx)(n.td,{children:"Can cancel mid-execution"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Client behavior"})}),(0,i.jsx)(n.td,{children:"Blocks until done"}),(0,i.jsx)(n.td,{children:"Non-blocking, polls for updates"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Use case"})}),(0,i.jsx)(n.td,{children:"Computation, queries"}),(0,i.jsx)(n.td,{children:"Navigation, manipulation"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Example"})}),(0,i.jsx)(n.td,{children:"Calculate path"}),(0,i.jsx)(n.td,{children:"Execute path"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"action-communication-flow",children:"Action Communication Flow"}),"\n",(0,i.jsx)(n.mermaid,{value:'sequenceDiagram\n    participant C as Action Client\n    participant AS as Action Server\n    participant R as Robot\n\n    C->>AS: Send Goal (navigate to X)\n    AS->>C: Goal Accepted\n    Note over AS,R: Start navigation\n\n    loop Every 1 second\n        AS->>C: Feedback (distance: 10m, progress: 10%)\n        AS->>C: Feedback (distance: 8m, progress: 30%)\n        AS->>C: Feedback (distance: 5m, progress: 50%)\n    end\n\n    alt Goal Succeeded\n        AS->>C: Result (success: true)\n    else Goal Failed\n        AS->>C: Result (success: false, error: "obstacle")\n    else Client Cancels\n        C->>AS: Cancel Goal\n        AS->>C: Result (success: false, canceled: true)\n    end'}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Key properties"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Asynchronous"}),": Client doesn't block waiting for result"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Preemptable"}),": Client can cancel goal at any time"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Stateful"}),": Server tracks goal status (accepted, executing, succeeded, aborted, canceled)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Typed"}),": Goal, feedback, and result have defined message types"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"action-server-example",children:"Action Server Example"}),"\n",(0,i.jsx)(n.p,{children:"Let's create an action server that simulates a robot moving to a target position:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# File: move_to_target_server.py\nimport time\nimport rclpy\nfrom rclpy.action import ActionServer\nfrom rclpy.node import Node\nfrom example_interfaces.action import Fibonacci  # Using Fibonacci as placeholder\n\n\nclass MoveToTargetServer(Node):\n    def __init__(self):\n        super().__init__('move_to_target_server')\n\n        # Create action server: action type, action name, callback\n        self._action_server = ActionServer(\n            self,\n            Fibonacci,  # Action type\n            'move_to_target',  # Action name\n            self.execute_callback\n        )\n\n        self.get_logger().info('Move To Target Action Server started!')\n\n    def execute_callback(self, goal_handle):\n        \"\"\"Called when a goal is received.\"\"\"\n        self.get_logger().info('Executing goal...')\n\n        # Get goal parameters\n        target_distance = goal_handle.request.order  # Using 'order' as target distance\n\n        # Feedback message\n        feedback_msg = Fibonacci.Feedback()\n\n        # Simulate movement with feedback\n        for i in range(target_distance):\n            # Check if goal was canceled\n            if goal_handle.is_cancel_requested:\n                goal_handle.canceled()\n                self.get_logger().info('Goal canceled')\n                return Fibonacci.Result()\n\n            # Publish feedback (progress)\n            feedback_msg.sequence.append(i)\n            goal_handle.publish_feedback(feedback_msg)\n            self.get_logger().info(f'Feedback: Progress {i}/{target_distance}')\n\n            time.sleep(1)  # Simulate 1 second per meter\n\n        # Goal succeeded\n        goal_handle.succeed()\n\n        # Build result message\n        result = Fibonacci.Result()\n        result.sequence = feedback_msg.sequence\n        self.get_logger().info('Goal succeeded!')\n\n        return result\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MoveToTargetServer()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Breakdown"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"ActionServer(node, action_type, action_name, callback)"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Callback signature"}),": ",(0,i.jsx)(n.code,{children:"def execute_callback(self, goal_handle)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"goal_handle"})," - Object to control goal lifecycle"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"goal_handle.request"})," - Goal parameters sent by client"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"goal_handle.publish_feedback(msg)"})," - Send progress update"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"goal_handle.is_cancel_requested"})," - Check if client canceled"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"goal_handle.succeed()"})," / ",(0,i.jsx)(n.code,{children:"goal_handle.canceled()"})," - Mark outcome"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Must return"})," ",(0,i.jsx)(n.code,{children:"Result"})," object"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Running the action server"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Terminal 1: Start action server\nsource /opt/ros/jazzy/setup.bash\npython3 move_to_target_server.py\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"action-client-example",children:"Action Client Example"}),"\n",(0,i.jsx)(n.p,{children:"Now create a client that sends a goal and monitors progress:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'# File: move_to_target_client.py\nimport rclpy\nfrom rclpy.action import ActionClient\nfrom rclpy.node import Node\nfrom example_interfaces.action import Fibonacci\n\n\nclass MoveToTargetClient(Node):\n    def __init__(self):\n        super().__init__(\'move_to_target_client\')\n\n        # Create action client: action type, action name\n        self._action_client = ActionClient(self, Fibonacci, \'move_to_target\')\n\n        self.get_logger().info(\'Waiting for action server...\')\n        self._action_client.wait_for_server()\n        self.get_logger().info(\'Action server available!\')\n\n    def send_goal(self, target_distance):\n        """Send a goal to the action server."""\n        goal_msg = Fibonacci.Goal()\n        goal_msg.order = target_distance\n\n        self.get_logger().info(f\'Sending goal: Move {target_distance} meters\')\n\n        # Send goal asynchronously\n        self._send_goal_future = self._action_client.send_goal_async(\n            goal_msg,\n            feedback_callback=self.feedback_callback\n        )\n\n        self._send_goal_future.add_done_callback(self.goal_response_callback)\n\n    def goal_response_callback(self, future):\n        """Called when server accepts or rejects goal."""\n        goal_handle = future.result()\n\n        if not goal_handle.accepted:\n            self.get_logger().info(\'Goal rejected\')\n            return\n\n        self.get_logger().info(\'Goal accepted\')\n\n        # Wait for result\n        self._get_result_future = goal_handle.get_result_async()\n        self._get_result_future.add_done_callback(self.get_result_callback)\n\n    def get_result_callback(self, future):\n        """Called when action is complete."""\n        result = future.result().result\n        self.get_logger().info(f\'Result: {result.sequence}\')\n        rclpy.shutdown()\n\n    def feedback_callback(self, feedback_msg):\n        """Called when feedback is received."""\n        feedback = feedback_msg.feedback\n        self.get_logger().info(f\'Feedback: {feedback.sequence}\')\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MoveToTargetClient()\n\n    # Send goal to move 5 meters\n    node.send_goal(5)\n\n    rclpy.spin(node)\n\n\nif __name__ == \'__main__\':\n    main()\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Breakdown"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ActionClient(node, action_type, action_name)"})," - Creates client"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"send_goal_async(goal, feedback_callback)"})," - Sends goal non-blocking"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Callbacks"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"goal_response_callback"})," - Server accepted/rejected goal"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"feedback_callback"})," - Progress updates during execution"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"get_result_callback"})," - Final result when action completes"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Running the action client"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Terminal 2: Send action goal\nsource /opt/ros/jazzy/setup.bash\npython3 move_to_target_client.py\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Expected output"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[INFO] [move_to_target_client]: Action server available!\n[INFO] [move_to_target_client]: Sending goal: Move 5 meters\n[INFO] [move_to_target_client]: Goal accepted\n[INFO] [move_to_target_client]: Feedback: [0]\n[INFO] [move_to_target_client]: Feedback: [0, 1]\n[INFO] [move_to_target_client]: Feedback: [0, 1, 2]\n[INFO] [move_to_target_client]: Feedback: [0, 1, 2, 3]\n[INFO] [move_to_target_client]: Feedback: [0, 1, 2, 3, 4]\n[INFO] [move_to_target_client]: Result: [0, 1, 2, 3, 4]\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"action-introspection-with-cli",children:"Action Introspection with CLI"}),"\n",(0,i.jsx)(n.p,{children:"While actions are running, use these commands:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# List all active actions\nros2 action list\n# Output:\n# /move_to_target\n\n# Show action type\nros2 action type /move_to_target\n# Output: example_interfaces/action/Fibonacci\n\n# Send action goal from command line\nros2 action send_goal /move_to_target example_interfaces/action/Fibonacci "{order: 3}" --feedback\n\n# View action definition\nros2 interface show example_interfaces/action/Fibonacci\n# Output:\n# int32 order\n# ---\n# int32[] sequence\n# ---\n# int32[] sequence\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note the three sections"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Goal"})," (above first ",(0,i.jsx)(n.code,{children:"---"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Result"})," (between first and second ",(0,i.jsx)(n.code,{children:"---"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Feedback"})," (below second ",(0,i.jsx)(n.code,{children:"---"}),")"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"when-to-use-topics-services-or-actions",children:"When to Use Topics, Services, or Actions?"}),"\n",(0,i.jsx)(n.mermaid,{value:"graph TD\n    Start[Choose Communication Pattern]\n    Start --\x3e Q1{Continuous data stream?}\n    Q1 --\x3e|Yes| Topic[Use TOPIC]\n    Q1 --\x3e|No| Q2{Need immediate response?}\n    Q2 --\x3e|Yes instantly| Q3{Long-running task?}\n    Q3 --\x3e|No quick| Service[Use SERVICE]\n    Q3 --\x3e|Yes slow| Q4{Need progress updates?}\n    Q4 --\x3e|Yes| Action[Use ACTION]\n    Q4 --\x3e|No| Service2[Use SERVICE with timeout]\n\n    Topic --\x3e Ex1[Examples: sensor data,<br/>velocity commands,<br/>camera images]\n    Service --\x3e Ex2[Examples: compute path,<br/>get parameter,<br/>trigger calibration]\n    Action --\x3e Ex3[Examples: navigate to goal,<br/>grasp object,<br/>execute trajectory]"}),"\n",(0,i.jsx)(n.h3,{id:"decision-matrix",children:"Decision Matrix"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Use Case"}),(0,i.jsx)(n.th,{children:"Pattern"}),(0,i.jsx)(n.th,{children:"Rationale"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Camera publishes images 30 Hz"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Topic"})}),(0,i.jsx)(n.td,{children:"Continuous stream, many subscribers"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Query robot battery level"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Service"})}),(0,i.jsx)(n.td,{children:"One-time request, instant response"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Navigate to waypoint (20 sec)"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Action"})}),(0,i.jsx)(n.td,{children:"Long-running, needs feedback, cancellable"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Emergency stop command"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Topic"})}),(0,i.jsx)(n.td,{children:"Latency-critical, broadcast to all nodes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Calculate inverse kinematics"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Service"})}),(0,i.jsx)(n.td,{children:"Computation, deterministic result"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Pick and place object (5 sec)"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Action"})}),(0,i.jsx)(n.td,{children:"Multi-step task, can fail midway"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Lidar publishes scans 10 Hz"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Topic"})}),(0,i.jsx)(n.td,{children:"Continuous stream, multiple consumers"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Reset localization module"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Service"})}),(0,i.jsx)(n.td,{children:"One-time trigger, quick operation"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Execute trajectory (variable time)"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Action"})}),(0,i.jsx)(n.td,{children:"Long-running, feedback on joint positions"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"practical-example-robot-delivery-system",children:"Practical Example: Robot Delivery System"}),"\n",(0,i.jsx)(n.p,{children:"Let's combine all three patterns in a realistic scenario:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# File: delivery_robot.py\nimport rclpy\nfrom rclpy.node import Node\nfrom rclpy.action import ActionClient\nfrom geometry_msgs.msg import Twist\nfrom std_srvs.srv import Trigger\nfrom example_interfaces.action import Fibonacci  # Placeholder for NavigateToGoal\n\n\nclass DeliveryRobot(Node):\n    def __init__(self):\n        super().__init__('delivery_robot')\n\n        # TOPIC: Publish velocity commands\n        self.cmd_vel_pub = self.create_publisher(Twist, '/cmd_vel', 10)\n\n        # SERVICE: Check if cargo is loaded\n        self.cargo_check_client = self.create_client(Trigger, '/check_cargo')\n\n        # ACTION: Navigate to delivery location\n        self.navigate_client = ActionClient(self, Fibonacci, '/navigate_to_goal')\n\n        self.get_logger().info('Delivery robot initialized!')\n\n    def start_delivery(self, target_location):\n        \"\"\"Main delivery workflow.\"\"\"\n        # Step 1: SERVICE - Verify cargo is loaded\n        self.get_logger().info('Step 1: Checking cargo...')\n        if not self.check_cargo():\n            self.get_logger().error('No cargo loaded! Aborting.')\n            return\n\n        # Step 2: ACTION - Navigate to target (with feedback)\n        self.get_logger().info(f'Step 2: Navigating to {target_location}...')\n        self.navigate_to(target_location)\n\n        # Step 3: TOPIC - Stop robot when arrived\n        self.get_logger().info('Step 3: Stopping robot...')\n        self.stop_robot()\n\n        self.get_logger().info('Delivery complete!')\n\n    def check_cargo(self):\n        \"\"\"Call service to check cargo status.\"\"\"\n        request = Trigger.Request()\n        future = self.cargo_check_client.call_async(request)\n        rclpy.spin_until_future_complete(self, future)\n\n        if future.result() and future.result().success:\n            self.get_logger().info('Cargo loaded: OK')\n            return True\n        else:\n            return False\n\n    def navigate_to(self, target):\n        \"\"\"Send action goal to navigate.\"\"\"\n        goal_msg = Fibonacci.Goal()\n        goal_msg.order = target  # Using order as location ID\n\n        goal_future = self.navigate_client.send_goal_async(\n            goal_msg,\n            feedback_callback=self.navigation_feedback\n        )\n\n        rclpy.spin_until_future_complete(self, goal_future)\n        goal_handle = goal_future.result()\n\n        if not goal_handle.accepted:\n            self.get_logger().error('Navigation goal rejected')\n            return\n\n        result_future = goal_handle.get_result_async()\n        rclpy.spin_until_future_complete(self, result_future)\n\n    def navigation_feedback(self, feedback_msg):\n        \"\"\"Handle navigation progress updates.\"\"\"\n        progress = feedback_msg.feedback.sequence\n        self.get_logger().info(f'Navigation progress: {len(progress)} waypoints')\n\n    def stop_robot(self):\n        \"\"\"Publish zero velocity to stop.\"\"\"\n        stop_msg = Twist()  # All fields default to 0.0\n        self.cmd_vel_pub.publish(stop_msg)\n        self.get_logger().info('Published stop command')\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    robot = DeliveryRobot()\n\n    # Start delivery to location 5\n    robot.start_delivery(target_location=5)\n\n    robot.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Architecture breakdown"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["Topic (",(0,i.jsx)(n.code,{children:"/cmd_vel"}),")"]}),": Real-time velocity control (latency-critical)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["Service (",(0,i.jsx)(n.code,{children:"/check_cargo"}),")"]}),": Quick status check before starting"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["Action (",(0,i.jsx)(n.code,{children:"/navigate_to_goal"}),")"]}),": Long navigation task with progress updates"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"common-pitfalls-and-solutions",children:"Common Pitfalls and Solutions"}),"\n",(0,i.jsx)(n.h3,{id:"1-service-call-times-out",children:'1. "Service call times out"'}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Symptom"}),": ",(0,i.jsx)(n.code,{children:"call_async()"})," never returns, or timeout error"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Debug steps"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Check if service exists\nros2 service list | grep my_service\n\n# Check if server node is running\nros2 node list\n\n# Test service from CLI\nros2 service call /my_service std_srvs/srv/Trigger\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Common causes"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Server node not running"}),"\n",(0,i.jsx)(n.li,{children:"Service name mismatch (typo, case-sensitive)"}),"\n",(0,i.jsx)(n.li,{children:"Server crashed during request processing"}),"\n",(0,i.jsx)(n.li,{children:"Network issues (DDS discovery)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"2-action-feedback-not-received",children:'2. "Action feedback not received"'}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Symptom"}),": Goal accepted, but no feedback callbacks triggered"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Cause"}),": Forgot to pass ",(0,i.jsx)(n.code,{children:"feedback_callback"})," to ",(0,i.jsx)(n.code,{children:"send_goal_async()"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Wrong: No feedback callback\ngoal_future = client.send_goal_async(goal_msg)\n\n# Correct: Specify feedback callback\ngoal_future = client.send_goal_async(goal_msg, feedback_callback=self.feedback_cb)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"3-service-response-is-none",children:'3. "Service response is None"'}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Symptom"}),": ",(0,i.jsx)(n.code,{children:"future.result()"})," returns ",(0,i.jsx)(n.code,{children:"None"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Cause"}),": Server callback didn't return the response object"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'def my_service_callback(self, request, response):\n    response.success = True\n    response.message = "Done"\n    return response  # MUST return response object\n'})}),"\n",(0,i.jsx)(n.h3,{id:"4-action-goal-immediately-rejected",children:'4. "Action goal immediately rejected"'}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Symptom"}),": ",(0,i.jsx)(n.code,{children:"goal_handle.accepted"})," is ",(0,i.jsx)(n.code,{children:"False"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Debug steps"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Check action server status\nros2 action info /my_action\n\n# See action definition\nros2 interface show my_package/action/MyAction\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Common causes"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Action server busy with another goal (if not multi-goal)"}),"\n",(0,i.jsx)(n.li,{children:"Invalid goal parameters (type mismatch)"}),"\n",(0,i.jsx)(n.li,{children:"Server validation logic rejected goal"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Services"})," are for quick request-response interactions (compute, query, trigger)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Actions"})," are for long-running tasks that need feedback and cancellation (navigate, manipulate)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Topics"})," remain best for continuous data streams (sensors, commands)"]}),"\n",(0,i.jsxs)(n.li,{children:["Choose the right pattern based on ",(0,i.jsx)(n.strong,{children:"duration"}),", ",(0,i.jsx)(n.strong,{children:"feedback needs"}),", and ",(0,i.jsx)(n.strong,{children:"latency requirements"})]}),"\n",(0,i.jsxs)(n.li,{children:["Use CLI tools (",(0,i.jsx)(n.code,{children:"ros2 service"}),", ",(0,i.jsx)(n.code,{children:"ros2 action"}),") for testing and debugging"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"exercises",children:"Exercises"}),"\n",(0,i.jsx)(n.p,{children:"Try these hands-on challenges:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Service"}),": Create a service that converts Celsius to Fahrenheit"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Define custom ",(0,i.jsx)(n.code,{children:".srv"})," file (or use ",(0,i.jsx)(n.code,{children:"example_interfaces"}),")"]}),"\n",(0,i.jsx)(n.li,{children:"Implement server that performs conversion"}),"\n",(0,i.jsxs)(n.li,{children:["Test with CLI: ",(0,i.jsx)(n.code,{children:"ros2 service call /convert_temp ..."})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Action"}),": Create an action that counts down from N to 0"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Publish feedback every second with remaining count"}),"\n",(0,i.jsx)(n.li,{children:"Allow client to cancel countdown midway"}),"\n",(0,i.jsxs)(n.li,{children:["Test cancellation with ",(0,i.jsx)(n.code,{children:"Ctrl+C"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Integration"}),': Build a "coffee maker" simulation']}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Service: Check if water tank is full (",(0,i.jsx)(n.code,{children:"/check_water"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["Action: Brew coffee with progress updates (",(0,i.jsx)(n.code,{children:"/brew_coffee"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["Topic: Publish temperature readings (",(0,i.jsx)(n.code,{children:"/temperature"}),")"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Error handling"}),": Modify service server to randomly fail 20% of requests"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Client should retry up to 3 times with exponential backoff"}),"\n",(0,i.jsx)(n.li,{children:"Log success/failure statistics"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"next-section",children:"Next Section"}),"\n",(0,i.jsxs)(n.p,{children:["Ready to configure your nodes? Continue to ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"./parameters-launch",children:"Section 3: Parameters & Launch Files"})})," to learn runtime configuration and multi-node orchestration."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"further-reading",children:"Further Reading"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"ROS 2 Services"}),": ",(0,i.jsx)(n.a,{href:"https://docs.ros.org/en/jazzy/Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Services.html",children:"https://docs.ros.org/en/jazzy/Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Services.html"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"ROS 2 Actions"}),": ",(0,i.jsx)(n.a,{href:"https://docs.ros.org/en/jazzy/Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Actions.html",children:"https://docs.ros.org/en/jazzy/Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Actions.html"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Custom Interfaces"}),": ",(0,i.jsx)(n.a,{href:"https://docs.ros.org/en/jazzy/Tutorials/Beginner-Client-Libraries/Custom-ROS2-Interfaces.html",children:"https://docs.ros.org/en/jazzy/Tutorials/Beginner-Client-Libraries/Custom-ROS2-Interfaces.html"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Action Design Patterns"}),": ",(0,i.jsx)(n.a,{href:"https://design.ros2.org/articles/actions.html",children:"https://design.ros2.org/articles/actions.html"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>l});var r=s(6540);const i={},t=r.createContext(i);function c(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);