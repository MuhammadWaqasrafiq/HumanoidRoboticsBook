"use strict";(self.webpackChunkphysical_ai_humanoid_robotics_book=self.webpackChunkphysical_ai_humanoid_robotics_book||[]).push([[6464],{6606:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>t,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"ros2-fundamentals/nodes-topics","title":"Section 1 - Nodes & Topics","description":"Understanding ROS 2 nodes and the publish-subscribe communication pattern","source":"@site/docs/ros2-fundamentals/nodes-topics.mdx","sourceDirName":"ros2-fundamentals","slug":"/ros2-fundamentals/nodes-topics","permalink":"/HumanoidRoboticsBook/docs/ros2-fundamentals/nodes-topics","draft":false,"unlisted":false,"editUrl":"https://github.com/MuhammadWaqasrafiq/HumanoidRoboticsBook/tree/main/docs/ros2-fundamentals/nodes-topics.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"id":"nodes-topics","title":"Section 1 - Nodes & Topics","sidebar_position":1,"description":"Understanding ROS 2 nodes and the publish-subscribe communication pattern","keywords":["ros2-nodes","ros2-topics","pub-sub","rclpy","publisher","subscriber"]},"sidebar":"tutorialSidebar","previous":{"title":"Overview","permalink":"/HumanoidRoboticsBook/docs/ros2-fundamentals/"},"next":{"title":"Services & Actions","permalink":"/HumanoidRoboticsBook/docs/ros2-fundamentals/services-actions"}}');var r=n(4848),o=n(8453);const l={id:"nodes-topics",title:"Section 1 - Nodes & Topics",sidebar_position:1,description:"Understanding ROS 2 nodes and the publish-subscribe communication pattern",keywords:["ros2-nodes","ros2-topics","pub-sub","rclpy","publisher","subscriber"]},t="Section 1: Nodes & Topics",a={},c=[{value:"What is a ROS 2 Node?",id:"what-is-a-ros-2-node",level:2},{value:"Node Anatomy",id:"node-anatomy",level:3},{value:"What is a Topic?",id:"what-is-a-topic",level:2},{value:"Topic Communication Flow",id:"topic-communication-flow",level:3},{value:"Publisher Node Example",id:"publisher-node-example",level:2},{value:"Subscriber Node Example",id:"subscriber-node-example",level:2},{value:"Topic Introspection with CLI",id:"topic-introspection-with-cli",level:2},{value:"Message Types",id:"message-types",level:2},{value:"std_msgs (Standard Messages)",id:"std_msgs-standard-messages",level:3},{value:"geometry_msgs (Robotics Messages)",id:"geometry_msgs-robotics-messages",level:3},{value:"sensor_msgs (Sensor Data)",id:"sensor_msgs-sensor-data",level:3},{value:"Quality of Service (QoS)",id:"quality-of-service-qos",level:2},{value:"Reliability",id:"reliability",level:3},{value:"Durability",id:"durability",level:3},{value:"History",id:"history",level:3},{value:"Practical Example: Robot Velocity Controller",id:"practical-example-robot-velocity-controller",level:2},{value:"Common Pitfalls and Solutions",id:"common-pitfalls-and-solutions",level:2},{value:"1. &quot;Node not publishing/receiving&quot;",id:"1-node-not-publishingreceiving",level:3},{value:"2. &quot;Messages arriving out of order&quot;",id:"2-messages-arriving-out-of-order",level:3},{value:"3. &quot;High CPU usage / slow performance&quot;",id:"3-high-cpu-usage--slow-performance",level:3},{value:"4. &quot;Subscriber receives old messages&quot;",id:"4-subscriber-receives-old-messages",level:3},{value:"Key Takeaways",id:"key-takeaways",level:2},{value:"Exercises",id:"exercises",level:2},{value:"Next Section",id:"next-section",level:2},{value:"Further Reading",id:"further-reading",level:2}];function d(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"section-1-nodes--topics",children:"Section 1: Nodes & Topics"})}),"\n",(0,r.jsx)(s.h2,{id:"what-is-a-ros-2-node",children:"What is a ROS 2 Node?"}),"\n",(0,r.jsxs)(s.p,{children:["A ",(0,r.jsx)(s.strong,{children:"node"})," is an independent executable process that performs computation. Think of it as a single-purpose program:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Camera node"}),": Publishes images from a camera"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Object detection node"}),": Subscribes to images, publishes detected objects"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Motor controller node"}),": Subscribes to velocity commands, controls motors"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Path planner node"}),": Publishes navigation waypoints"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Key principle"}),": Each node should do ",(0,r.jsx)(s.strong,{children:"one thing well"}),". This modularity allows:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Reusability"}),": Camera node works with any subscriber"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Debugging"}),": Isolate issues to specific nodes"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Parallel development"}),": Teams work on different nodes simultaneously"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Fault tolerance"}),": One node crash doesn't bring down the entire system"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"node-anatomy",children:"Node Anatomy"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\n\nclass MinimalNode(Node):\n    def __init__(self):\n        super().__init__('minimal_node')  # Node name\n        self.get_logger().info('Node started!')\n\ndef main():\n    rclpy.init()           # Initialize ROS 2\n    node = MinimalNode()   # Create node instance\n    rclpy.spin(node)       # Keep node running\n    node.destroy_node()    # Cleanup\n    rclpy.shutdown()       # Shutdown ROS 2\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Lifecycle"}),":"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"rclpy.init()"})," - Initialize ROS 2 context"]}),"\n",(0,r.jsxs)(s.li,{children:["Create node instance (inherits from ",(0,r.jsx)(s.code,{children:"Node"})," class)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"rclpy.spin()"})," - Process callbacks (subscribers, timers, services)"]}),"\n",(0,r.jsxs)(s.li,{children:["Cleanup on exit (",(0,r.jsx)(s.code,{children:"destroy_node()"}),", ",(0,r.jsx)(s.code,{children:"shutdown()"}),")"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"what-is-a-topic",children:"What is a Topic?"}),"\n",(0,r.jsxs)(s.p,{children:["A ",(0,r.jsx)(s.strong,{children:"topic"})," is a named communication channel. Nodes publish messages to topics, and other nodes subscribe to receive those messages."]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Analogy"}),": Topics are like radio frequencies:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Publisher"})," = Radio station broadcasting on 101.5 FM"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Topic"})," = Frequency 101.5 FM"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Subscriber"})," = Car radio tuned to 101.5 FM"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"topic-communication-flow",children:"Topic Communication Flow"}),"\n",(0,r.jsx)(s.mermaid,{value:"sequenceDiagram\n    participant P as Publisher Node\n    participant T as Topic (/sensor_data)\n    participant S1 as Subscriber 1\n    participant S2 as Subscriber 2\n\n    P->>T: Publish message (10 Hz)\n    T->>S1: Deliver message\n    T->>S2: Deliver message\n    Note over P,S2: Multiple subscribers receive same data\n\n    P->>T: Publish next message\n    T->>S1: Deliver message\n    T->>S2: Deliver message"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Key properties"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Many-to-many"}),": Multiple publishers can publish to one topic, multiple subscribers can subscribe"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Anonymous"}),": Publishers don't know who's listening, subscribers don't know who's publishing"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Asynchronous"}),": No waiting for acknowledgment (fire-and-forget)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Typed"}),": Each topic has a message type (e.g., ",(0,r.jsx)(s.code,{children:"String"}),", ",(0,r.jsx)(s.code,{children:"Image"}),", ",(0,r.jsx)(s.code,{children:"Twist"}),")"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"publisher-node-example",children:"Publisher Node Example"}),"\n",(0,r.jsx)(s.p,{children:"Let's create a node that publishes a counter value every second:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"# File: simple_publisher.py\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass SimplePublisher(Node):\n    def __init__(self):\n        super().__init__('simple_publisher')\n\n        # Create publisher: topic name, message type, queue size\n        self.publisher_ = self.create_publisher(String, 'chatter', 10)\n\n        # Create timer: period (seconds), callback function\n        self.timer = self.create_timer(1.0, self.timer_callback)\n\n        self.counter = 0\n        self.get_logger().info('Publisher node started!')\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = f'Hello World: {self.counter}'\n        self.publisher_.publish(msg)\n        self.get_logger().info(f'Publishing: \"{msg.data}\"')\n        self.counter += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = SimplePublisher()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Breakdown"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"create_publisher(message_type, topic_name, queue_size)"}),":","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"String"})," - Message type from ",(0,r.jsx)(s.code,{children:"std_msgs.msg"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"'chatter'"})," - Topic name (by convention, starts with ",(0,r.jsx)(s.code,{children:"/"}),")"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"10"})," - Queue size (buffer for slow subscribers)"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"create_timer(period, callback)"})," - Runs callback every 1.0 seconds"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"publisher_.publish(msg)"})," - Send message to topic"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Running the publisher"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Terminal 1: Source ROS 2 and run publisher\nsource /opt/ros/jazzy/setup.bash\npython3 simple_publisher.py\n"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"subscriber-node-example",children:"Subscriber Node Example"}),"\n",(0,r.jsxs)(s.p,{children:["Now create a node that receives messages from the ",(0,r.jsx)(s.code,{children:"/chatter"})," topic:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"# File: simple_subscriber.py\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass SimpleSubscriber(Node):\n    def __init__(self):\n        super().__init__('simple_subscriber')\n\n        # Create subscriber: topic name, message type, callback function\n        self.subscription = self.create_subscription(\n            String,\n            'chatter',\n            self.listener_callback,\n            10  # Queue size\n        )\n        self.get_logger().info('Subscriber node started!')\n\n    def listener_callback(self, msg):\n        self.get_logger().info(f'I heard: \"{msg.data}\"')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = SimpleSubscriber()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Breakdown"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"create_subscription(message_type, topic_name, callback, queue_size)"}),":","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"String"})," - Must match publisher's message type"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"'chatter'"})," - Must match publisher's topic name"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"listener_callback"})," - Function called when message arrives"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"10"})," - Queue size"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"listener_callback(self, msg)"})," - Receives message object, extracts data"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Running the subscriber"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Terminal 2: Source ROS 2 and run subscriber\nsource /opt/ros/jazzy/setup.bash\npython3 simple_subscriber.py\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected output"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'[INFO] [simple_subscriber]: Subscriber node started!\n[INFO] [simple_subscriber]: I heard: "Hello World: 0"\n[INFO] [simple_subscriber]: I heard: "Hello World: 1"\n[INFO] [simple_subscriber]: I heard: "Hello World: 2"\n...\n'})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"topic-introspection-with-cli",children:"Topic Introspection with CLI"}),"\n",(0,r.jsx)(s.p,{children:"While nodes are running, use these commands to inspect topics:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# List all active topics\nros2 topic list\n# Output:\n# /chatter\n# /parameter_events\n# /rosout\n\n# Show topic info (type, publisher/subscriber count)\nros2 topic info /chatter\n# Output:\n# Type: std_msgs/msg/String\n# Publisher count: 1\n# Subscription count: 1\n\n# Display messages in real-time (Ctrl+C to stop)\nros2 topic echo /chatter\n# Output:\n# data: 'Hello World: 5'\n# ---\n# data: 'Hello World: 6'\n# ---\n\n# Show message publishing rate\nros2 topic hz /chatter\n# Output: average rate: 1.000\n\n# Publish a message from command line (one-shot)\nros2 topic pub /chatter std_msgs/msg/String \"data: 'Manual message'\"\n"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"message-types",children:"Message Types"}),"\n",(0,r.jsxs)(s.p,{children:["ROS 2 uses ",(0,r.jsx)(s.strong,{children:"strongly typed messages"}),". Common message packages:"]}),"\n",(0,r.jsx)(s.h3,{id:"std_msgs-standard-messages",children:"std_msgs (Standard Messages)"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:'from std_msgs.msg import String, Int32, Float64, Bool\n\n# String message\nmsg = String()\nmsg.data = "Hello"\n\n# Int32 message\ncount_msg = Int32()\ncount_msg.data = 42\n\n# Float64 message\ntemp_msg = Float64()\ntemp_msg.data = 23.5\n\n# Bool message\nstatus_msg = Bool()\nstatus_msg.data = True\n'})}),"\n",(0,r.jsx)(s.h3,{id:"geometry_msgs-robotics-messages",children:"geometry_msgs (Robotics Messages)"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"from geometry_msgs.msg import Twist, Point, Pose\n\n# Twist - velocity command (linear + angular)\ncmd_vel = Twist()\ncmd_vel.linear.x = 0.5   # Move forward 0.5 m/s\ncmd_vel.angular.z = 0.3  # Turn left 0.3 rad/s\n\n# Point - 3D position\npoint = Point()\npoint.x = 1.0\npoint.y = 2.0\npoint.z = 0.5\n\n# Pose - position + orientation (quaternion)\npose = Pose()\npose.position.x = 1.0\npose.position.y = 2.0\npose.orientation.w = 1.0  # No rotation\n"})}),"\n",(0,r.jsx)(s.h3,{id:"sensor_msgs-sensor-data",children:"sensor_msgs (Sensor Data)"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:'from sensor_msgs.msg import Image, LaserScan, Imu\n\n# Image - camera frame\nimage_msg = Image()\nimage_msg.height = 480\nimage_msg.width = 640\nimage_msg.encoding = "rgb8"\n# image_msg.data = [byte array]\n\n# LaserScan - LiDAR data\nscan_msg = LaserScan()\nscan_msg.angle_min = -3.14  # Start angle\nscan_msg.angle_max = 3.14   # End angle\nscan_msg.ranges = [1.0, 1.5, 2.0, ...]  # Distance readings\n'})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"View message definition"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"ros2 interface show std_msgs/msg/String\n# Output:\n# string data\n\nros2 interface show geometry_msgs/msg/Twist\n# Output shows full structure with linear/angular components\n"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"quality-of-service-qos",children:"Quality of Service (QoS)"}),"\n",(0,r.jsx)(s.p,{children:"QoS profiles control message delivery behavior. Key parameters:"}),"\n",(0,r.jsx)(s.h3,{id:"reliability",children:"Reliability"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"RELIABLE"})," (default for services): Guaranteed delivery, retransmits lost packets"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"BEST_EFFORT"}),": No retransmission, lower latency (good for sensor data)"]}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, ReliabilityPolicy\n\n# Best effort QoS (for high-frequency sensor data)\nqos_profile = QoSProfile(\n    reliability=ReliabilityPolicy.BEST_EFFORT,\n    depth=10\n)\n\nself.subscription = self.create_subscription(\n    LaserScan,\n    '/scan',\n    self.scan_callback,\n    qos_profile  # Use custom QoS\n)\n"})}),"\n",(0,r.jsx)(s.h3,{id:"durability",children:"Durability"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"VOLATILE"})," (default): Late subscribers only get new messages"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"TRANSIENT_LOCAL"}),": Late subscribers receive last published message"]}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"from rclpy.qos import DurabilityPolicy\n\n# Transient local - useful for configuration topics\nqos_profile = QoSProfile(\n    durability=DurabilityPolicy.TRANSIENT_LOCAL,\n    depth=1\n)\n"})}),"\n",(0,r.jsx)(s.h3,{id:"history",children:"History"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"KEEP_LAST"}),": Keep last N messages (depth parameter)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"KEEP_ALL"}),": Keep all messages (until memory limit)"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"practical-example-robot-velocity-controller",children:"Practical Example: Robot Velocity Controller"}),"\n",(0,r.jsx)(s.p,{children:"Let's create a realistic example: A node that publishes velocity commands to move a robot in a square pattern."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"# File: square_motion.py\nimport rclpy\nfrom rclpy.node import Node\nfrom geometry_msgs.msg import Twist\nimport math\n\nclass SquareMotion(Node):\n    def __init__(self):\n        super().__init__('square_motion')\n\n        self.publisher = self.create_publisher(Twist, '/cmd_vel', 10)\n        self.timer = self.create_timer(0.1, self.timer_callback)  # 10 Hz\n\n        self.state = 'forward'  # forward, turn, forward, turn, ...\n        self.elapsed_time = 0.0\n\n        self.get_logger().info('Square motion node started!')\n\n    def timer_callback(self):\n        msg = Twist()\n\n        if self.state == 'forward':\n            msg.linear.x = 0.2  # Move forward 0.2 m/s\n            msg.angular.z = 0.0\n\n            if self.elapsed_time >= 5.0:  # Move for 5 seconds (1 meter)\n                self.state = 'turn'\n                self.elapsed_time = 0.0\n                self.get_logger().info('Switching to turn')\n\n        elif self.state == 'turn':\n            msg.linear.x = 0.0\n            msg.angular.z = math.pi / 4  # Turn 45 deg/s (90 deg in 2 sec)\n\n            if self.elapsed_time >= 2.0:  # Turn for 2 seconds (90 degrees)\n                self.state = 'forward'\n                self.elapsed_time = 0.0\n                self.get_logger().info('Switching to forward')\n\n        self.publisher.publish(msg)\n        self.elapsed_time += 0.1  # Timer period\n\ndef main():\n    rclpy.init()\n    node = SquareMotion()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"How it works"}),":"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Publishes to ",(0,r.jsx)(s.code,{children:"/cmd_vel"})," topic (standard velocity command topic)"]}),"\n",(0,r.jsx)(s.li,{children:"State machine alternates between moving forward and turning"}),"\n",(0,r.jsx)(s.li,{children:"Moves forward 1 meter (5 seconds \xd7 0.2 m/s)"}),"\n",(0,r.jsx)(s.li,{children:"Turns 90 degrees (2 seconds \xd7 45 deg/s)"}),"\n",(0,r.jsx)(s.li,{children:"Repeats to trace a square"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Testing without a real robot"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Terminal 1: Run the motion node\npython3 square_motion.py\n\n# Terminal 2: Echo velocity commands to see the pattern\nros2 topic echo /cmd_vel\n"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"common-pitfalls-and-solutions",children:"Common Pitfalls and Solutions"}),"\n",(0,r.jsx)(s.h3,{id:"1-node-not-publishingreceiving",children:'1. "Node not publishing/receiving"'}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Symptom"}),": Subscriber doesn't receive messages"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Debug steps"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Check if topic exists\nros2 topic list | grep chatter\n\n# Check if publisher is active\nros2 topic info /chatter\n# Should show: Publisher count: 1\n\n# Check message type matches\nros2 topic info /chatter -v\n# Verify publisher and subscriber use same type\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Common causes"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Topic name mismatch (typo, case-sensitive)"}),"\n",(0,r.jsx)(s.li,{children:"Message type mismatch"}),"\n",(0,r.jsx)(s.li,{children:"Subscriber started before publisher (wait 1 second for discovery)"}),"\n",(0,r.jsx)(s.li,{children:"DDS discovery issues (firewall blocking multicast UDP)"}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"2-messages-arriving-out-of-order",children:'2. "Messages arriving out of order"'}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Cause"}),": Using BEST_EFFORT reliability with packet loss"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Solution"}),": Use RELIABLE QoS for critical data"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, ReliabilityPolicy\n\nqos = QoSProfile(reliability=ReliabilityPolicy.RELIABLE, depth=10)\nself.subscription = self.create_subscription(String, 'topic', callback, qos)\n"})}),"\n",(0,r.jsx)(s.h3,{id:"3-high-cpu-usage--slow-performance",children:'3. "High CPU usage / slow performance"'}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Cause"}),": Publishing too fast or processing heavy callbacks"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Solutions"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Reduce publishing rate: ",(0,r.jsx)(s.code,{children:"self.create_timer(0.1, callback)"})," \u2192 ",(0,r.jsx)(s.code,{children:"self.create_timer(1.0, callback)"})]}),"\n",(0,r.jsx)(s.li,{children:"Use QoS depth wisely: Large depth = more memory"}),"\n",(0,r.jsx)(s.li,{children:"Process heavy work in separate thread (avoid blocking callback)"}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"4-subscriber-receives-old-messages",children:'4. "Subscriber receives old messages"'}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Cause"}),": TRANSIENT_LOCAL durability with stale data"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Solution"}),": Use VOLATILE durability for real-time data"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"from rclpy.qos import DurabilityPolicy\n\nqos = QoSProfile(durability=DurabilityPolicy.VOLATILE, depth=10)\n"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Nodes"})," are independent processes, each with a single responsibility"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Topics"})," enable anonymous, asynchronous pub-sub communication"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Message types"})," must match between publisher and subscriber"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"QoS profiles"})," control reliability, durability, and history"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"CLI tools"})," (",(0,r.jsx)(s.code,{children:"ros2 topic list/echo/info/hz"}),") are essential for debugging"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"exercises",children:"Exercises"}),"\n",(0,r.jsx)(s.p,{children:"Try these hands-on challenges:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Modify publisher"}),": Change ",(0,r.jsx)(s.code,{children:"simple_publisher.py"})," to publish a random number instead of a counter"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Multi-subscriber"}),": Run two subscribers on the same topic, verify both receive messages"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Custom message"}),": Create a publisher that sends ",(0,r.jsx)(s.code,{children:"geometry_msgs/Twist"})," with random velocities"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Frequency test"}),": Measure actual publishing rate with ",(0,r.jsx)(s.code,{children:"ros2 topic hz"})," for different timer periods"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"next-section",children:"Next Section"}),"\n",(0,r.jsxs)(s.p,{children:["Ready for more advanced communication patterns? Continue to ",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.a,{href:"./services-actions",children:"Section 2: Services & Actions"})})," to learn request-response and goal-based interactions."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"further-reading",children:"Further Reading"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"ROS 2 Nodes"}),": ",(0,r.jsx)(s.a,{href:"https://docs.ros.org/en/jazzy/Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Nodes.html",children:"https://docs.ros.org/en/jazzy/Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Nodes.html"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"ROS 2 Topics"}),": ",(0,r.jsx)(s.a,{href:"https://docs.ros.org/en/jazzy/Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Topics.html",children:"https://docs.ros.org/en/jazzy/Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Topics.html"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"QoS Policies"}),": ",(0,r.jsx)(s.a,{href:"https://docs.ros.org/en/jazzy/Concepts/About-Quality-of-Service-Settings.html",children:"https://docs.ros.org/en/jazzy/Concepts/About-Quality-of-Service-Settings.html"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Message Types"}),": ",(0,r.jsx)(s.a,{href:"https://github.com/ros2/common_interfaces",children:"https://github.com/ros2/common_interfaces"})," (source code for std_msgs, geometry_msgs, sensor_msgs)"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>l,x:()=>t});var i=n(6540);const r={},o=i.createContext(r);function l(e){const s=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(o.Provider,{value:s},e.children)}}}]);