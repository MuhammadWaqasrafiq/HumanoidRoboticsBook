<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-bipedal-locomotion/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Chapter 08 - Bipedal Locomotion | Embodied AI: The Future of Robotics</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://muhammadwaqasrafiq.github.io/HumanoidRoboticsBook/img/social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://muhammadwaqasrafiq.github.io/HumanoidRoboticsBook/img/social-card.jpg"><meta data-rh="true" property="og:url" content="https://muhammadwaqasrafiq.github.io/HumanoidRoboticsBook/docs/bipedal-locomotion"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Chapter 08 - Bipedal Locomotion | Embodied AI: The Future of Robotics"><meta data-rh="true" name="description" content="Master gait generation, balance control, ZMP theory, and whole-body control for stable humanoid walking"><meta data-rh="true" property="og:description" content="Master gait generation, balance control, ZMP theory, and whole-body control for stable humanoid walking"><meta data-rh="true" name="keywords" content="bipedal-locomotion,gait-generation,balance-control,zmp,whole-body-control,humanoid-walking"><link data-rh="true" rel="icon" href="/HumanoidRoboticsBook/img/new_logo.svg"><link data-rh="true" rel="canonical" href="https://muhammadwaqasrafiq.github.io/HumanoidRoboticsBook/docs/bipedal-locomotion"><link data-rh="true" rel="alternate" href="https://muhammadwaqasrafiq.github.io/HumanoidRoboticsBook/docs/bipedal-locomotion" hreflang="en"><link data-rh="true" rel="alternate" href="https://muhammadwaqasrafiq.github.io/HumanoidRoboticsBook/docs/bipedal-locomotion" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"08. Bipedal Locomotion","item":"https://muhammadwaqasrafiq.github.io/HumanoidRoboticsBook/docs/bipedal-locomotion/"}]}</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"><link rel="stylesheet" href="/HumanoidRoboticsBook/assets/css/styles.a6d7e190.css">
<script src="/HumanoidRoboticsBook/assets/js/runtime~main.803ab506.js" defer="defer"></script>
<script src="/HumanoidRoboticsBook/assets/js/main.a5cf34ea.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/HumanoidRoboticsBook/"><div class="navbar__logo"><img src="/HumanoidRoboticsBook/img/new_logo.svg" alt="Embodied AI Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/HumanoidRoboticsBook/img/new_logo.svg" alt="Embodied AI Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Embodied AI</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/HumanoidRoboticsBook/docs/intro">Book</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/MuhammadWaqasrafiq/HumanoidRoboticsBook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/HumanoidRoboticsBook/docs/intro"><span title="Introduction" class="linkLabel_WmDU">Introduction</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/HumanoidRoboticsBook/docs/why-physical-ai"><span title="Part I: Foundation" class="categoryLinkLabel_W154">Part I: Foundation</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/HumanoidRoboticsBook/docs/why-physical-ai"><span title="01. Why Physical AI Is the Next Frontier" class="linkLabel_WmDU">01. Why Physical AI Is the Next Frontier</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/HumanoidRoboticsBook/docs/hardware-2026"><span title="02. The Hardware You Actually Need in 2026" class="linkLabel_WmDU">02. The Hardware You Actually Need in 2026</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/HumanoidRoboticsBook/docs/ros2-fundamentals"><span title="Part II: ROS 2 &amp; Simulation" class="categoryLinkLabel_W154">Part II: ROS 2 &amp; Simulation</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/HumanoidRoboticsBook/docs/ros2-fundamentals"><span title="03. ROS 2 – The Robotic Nervous System" class="categoryLinkLabel_W154">03. ROS 2 – The Robotic Nervous System</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/HumanoidRoboticsBook/docs/urdf-digital-twins"><span title="04. URDF &amp; Digital Twins" class="linkLabel_WmDU">04. URDF &amp; Digital Twins</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/HumanoidRoboticsBook/docs/simulation-ecosystem"><span title="05. Gazebo vs Isaac Sim" class="linkLabel_WmDU">05. Gazebo vs Isaac Sim</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/HumanoidRoboticsBook/docs/isaac-platform"><span title="06. NVIDIA Isaac Platform" class="linkLabel_WmDU">06. NVIDIA Isaac Platform</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/HumanoidRoboticsBook/docs/perception-stack"><span title="Part III: Core Robotics" class="categoryLinkLabel_W154">Part III: Core Robotics</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/HumanoidRoboticsBook/docs/perception-stack"><span title="07. Perception Stack" class="linkLabel_WmDU">07. Perception Stack</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/HumanoidRoboticsBook/docs/bipedal-locomotion"><span title="08. Bipedal Locomotion" class="linkLabel_WmDU">08. Bipedal Locomotion</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/HumanoidRoboticsBook/docs/dexterous-manipulation"><span title="09. Dexterous Manipulation" class="linkLabel_WmDU">09. Dexterous Manipulation</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/HumanoidRoboticsBook/docs/vla-models"><span title="Part IV: Intelligence Layer" class="categoryLinkLabel_W154">Part IV: Intelligence Layer</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/HumanoidRoboticsBook/docs/vla-models"><span title="10. Vision-Language-Action Models" class="linkLabel_WmDU">10. Vision-Language-Action Models</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/HumanoidRoboticsBook/docs/voice-to-action"><span title="11. Voice-to-Action Pipeline" class="linkLabel_WmDU">11. Voice-to-Action Pipeline</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/HumanoidRoboticsBook/docs/sim-to-real"><span title="12. Sim-to-Real Transfer" class="linkLabel_WmDU">12. Sim-to-Real Transfer</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/HumanoidRoboticsBook/docs/capstone-butler"><span title="Part V: Integration" class="categoryLinkLabel_W154">Part V: Integration</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/HumanoidRoboticsBook/docs/capstone-butler"><span title="13. Capstone: Autonomous Butler" class="linkLabel_WmDU">13. Capstone: Autonomous Butler</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/HumanoidRoboticsBook/docs/appendices/lab-build-guides"><span title="Appendices" class="categoryLinkLabel_W154">Appendices</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/HumanoidRoboticsBook/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Part III: Core Robotics</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">08. Bipedal Locomotion</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Chapter 08: Bipedal Locomotion for Humanoid Robots</h1></header>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Chapter Overview</div><div class="admonitionContent_BuS1"><p>Learn how humanoids walk, run, and maintain balance on two legs. Master gait generation algorithms, Zero Moment Point (ZMP) theory, balance controllers, and whole-body control for stable locomotion on flat and uneven terrain.</p></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="what-youll-learn">What You&#x27;ll Learn<a href="#what-youll-learn" class="hash-link" aria-label="Direct link to What You&#x27;ll Learn" title="Direct link to What You&#x27;ll Learn" translate="no">​</a></h2>
<p>By the end of this chapter, you&#x27;ll be able to:</p>
<ul>
<li class="">✅ Generate stable walking gaits using ZMP-based trajectory planning</li>
<li class="">✅ Implement balance control algorithms (<code>COM</code> stabilization, ankle/hip strategies)</li>
<li class="">✅ Design whole-body controllers for joint torque computation</li>
<li class="">✅ Handle locomotion on flat surfaces at 0.5 m/s walking speed</li>
<li class="">✅ Detect and recover from push perturbations within 1.5 seconds</li>
<li class="">✅ Implement gait state machines for transitions (stand → walk → run)</li>
<li class="">✅ Debug common locomotion failures (tipping, foot slip, oscillations)</li>
<li class="">✅ Integrate locomotion with perception and manipulation</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites" translate="no">​</a></h2>
<p>Before starting this chapter, you should:</p>
<ul>
<li class="">✅ Complete <strong><a class="" href="/HumanoidRoboticsBook/ros2-fundamentals">Chapter 03: ROS 2 Fundamentals</a></strong> (topics, actions)</li>
<li class="">✅ Complete <strong><a class="" href="/HumanoidRoboticsBook/urdf-digital-twins">Chapter 04: URDF &amp; Digital Twins</a></strong> (kinematics, dynamics)</li>
<li class="">✅ Understand basic control theory (PID, state feedback)</li>
<li class="">✅ Have Python 3.10+, ROS 2 Iron, NumPy/SciPy installed</li>
<li class="">✅ Have Isaac Sim 2025.1+ for simulation testing</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Hardware Requirements (Simulation)</div><div class="admonitionContent_BuS1"><p><strong>Minimum:</strong> GTX 1660 (6 GB) for Isaac Sim locomotion sim
<strong>Recommended:</strong> RTX 4060 Ti (16 GB) for real-time physics simulation
<strong>Professional:</strong> RTX 4070 Ti+ (12-24 GB) for multiple humanoids</p></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="why-bipedal-locomotion-is-hard">Why Bipedal Locomotion is Hard<a href="#why-bipedal-locomotion-is-hard" class="hash-link" aria-label="Direct link to Why Bipedal Locomotion is Hard" title="Direct link to Why Bipedal Locomotion is Hard" translate="no">​</a></h2>
<p><strong>Challenges unique to two-legged walking:</strong></p>
<ol>
<li class=""><strong>Underactuated system:</strong> Fewer contact points than wheels/legs (unstable equilibrium)</li>
<li class=""><strong>Hybrid dynamics:</strong> Continuous (swing phase) + discrete (foot contact) transitions</li>
<li class=""><strong>Balance constraints:</strong> Center of Mass (<code>COM</code>) must stay within support polygon</li>
<li class=""><strong>Impact forces:</strong> Foot strikes generate high forces (2-3x body weight)</li>
<li class=""><strong>Terrain adaptation:</strong> Uneven surfaces require continuous adjustment</li>
</ol>
<p><strong>Why solve it anyway?</strong></p>
<ul>
<li class="">Navigate human environments (stairs, narrow spaces)</li>
<li class="">Energy efficiency (walking vs. wheeled on rough terrain)</li>
<li class="">Social acceptance (human-like appearance)</li>
<li class="">Manipulation while moving (whole-body coordination)</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="gait-generation-fundamentals">Gait Generation Fundamentals<a href="#gait-generation-fundamentals" class="hash-link" aria-label="Direct link to Gait Generation Fundamentals" title="Direct link to Gait Generation Fundamentals" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="walking-cycle-phases">Walking Cycle Phases<a href="#walking-cycle-phases" class="hash-link" aria-label="Direct link to Walking Cycle Phases" title="Direct link to Walking Cycle Phases" translate="no">​</a></h3>
<p>A complete walking cycle (stride) has 8 phases:</p>
<!-- -->
<p><strong>Key parameters:</strong></p>
<ul>
<li class=""><strong>Step length:</strong> 0.3-0.6m (typical adult walking)</li>
<li class=""><strong>Step width:</strong> 0.1-0.15m (lateral stability)</li>
<li class=""><strong>Step height:</strong> 0.05-0.08m (foot clearance)</li>
<li class=""><strong>Cycle time:</strong> 1.0-1.2s (walking), 0.6-0.8s (running)</li>
<li class=""><strong>Double support ratio:</strong> 20% (walking), 0% (running - flight phase)</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="zero-moment-point-zmp-theory">Zero Moment Point (ZMP) Theory<a href="#zero-moment-point-zmp-theory" class="hash-link" aria-label="Direct link to Zero Moment Point (ZMP) Theory" title="Direct link to Zero Moment Point (ZMP) Theory" translate="no">​</a></h3>
<p><strong>Definition:</strong> Point on the ground where the net moment from ground reaction forces is zero.</p>
<p><strong>Physical intuition:</strong></p>
<ul>
<li class="">If ZMP is inside the support polygon → robot is stable</li>
<li class="">If ZMP reaches polygon edge → robot begins to tip</li>
<li class="">If ZMP is outside polygon → robot is falling (unrecoverable)</li>
</ul>
<p><strong>Mathematical formulation:</strong></p>
<p>For a humanoid with center of mass at position (x_com, y_com, z_com):</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ZMP_x = x_com - (z_com / (g + z_com_ddot)) * x_com_ddot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ZMP_y = y_com - (z_com / (g + z_com_ddot)) * y_com_ddot</span><br></span></code></pre></div></div>
<p>Where:</p>
<ul>
<li class=""><code>g = 9.81 m/s²</code> (gravity)</li>
<li class=""><code>x_com_ddot</code>, <code>y_com_ddot</code>, <code>z_com_ddot</code> = <code>COM</code> accelerations</li>
</ul>
<p><strong>Stability condition:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ZMP ∈ Support Polygon</span><br></span></code></pre></div></div>
<p>For single support (one foot): polygon is foot outline
For double support (two feet): polygon is convex hull of both feet</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="zmp-based-gait-planning">ZMP-Based Gait Planning<a href="#zmp-based-gait-planning" class="hash-link" aria-label="Direct link to ZMP-Based Gait Planning" title="Direct link to ZMP-Based Gait Planning" translate="no">​</a></h3>
<p><strong>Goal:</strong> Generate <code>COM</code> trajectory such that ZMP stays inside support polygon.</p>
<!-- -->
<p><strong>Linear Inverted Pendulum Model (LIPM):</strong></p>
<p>Simplified humanoid dynamics:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">x_com_ddot = (g / z_com) * (x_com - ZMP_x)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">y_com_ddot = (g / z_com) * (y_com - ZMP_y)</span><br></span></code></pre></div></div>
<p>This allows solving for <code>COM</code> trajectory that produces desired ZMP.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="gait-generator-implementation">Gait Generator Implementation<a href="#gait-generator-implementation" class="hash-link" aria-label="Direct link to Gait Generator Implementation" title="Direct link to Gait Generator Implementation" translate="no">​</a></h3>
<p>See <code>code-examples/locomotion/gait_generator.py</code> for complete implementation.</p>
<p><strong>Key algorithms:</strong></p>
<ol>
<li class=""><strong>Footstep planner:</strong> Generate foot positions for N steps ahead</li>
<li class=""><strong>ZMP reference:</strong> Define desired ZMP trajectory (center of support polygon)</li>
<li class=""><strong>Preview controller:</strong> Solve for <code>COM</code> trajectory (quadratic optimization)</li>
<li class=""><strong>Swing foot trajectory:</strong> Polynomial interpolation for smooth foot motion</li>
</ol>
<p><strong>Expected outputs:</strong></p>
<ul>
<li class=""><code>COM</code> trajectory: 100 Hz</li>
<li class="">Foot trajectories: 100 Hz</li>
<li class="">Joint angles: via whole-body inverse kinematics</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="balance-control">Balance Control<a href="#balance-control" class="hash-link" aria-label="Direct link to Balance Control" title="Direct link to Balance Control" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="center-of-mass-com-stabilization">Center of Mass (<code>COM</code>) Stabilization<a href="#center-of-mass-com-stabilization" class="hash-link" aria-label="Direct link to center-of-mass-com-stabilization" title="Direct link to center-of-mass-com-stabilization" translate="no">​</a></h3>
<p><strong>Problem:</strong> Real robot deviates from planned trajectory due to:</p>
<ul>
<li class="">Model errors (unmodeled dynamics)</li>
<li class="">External disturbances (push, uneven terrain)</li>
<li class="">Sensor noise (IMU drift, encoder backlash)</li>
</ul>
<p><strong>Solution:</strong> Feedback control to correct <code>COM</code> position/velocity.</p>
<!-- -->
<p><strong>COM PID controller:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Position error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">e_pos </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> com_desired </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> com_actual</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Velocity error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">e_vel </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> com_vel_desired </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> com_vel_actual</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># PID output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">delta_com </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Kp </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> e_pos </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> Kd </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> e_vel </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> Ki </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> integral</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e_pos</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p><strong>Typical gains for humanoid (mass ~50kg, height ~1.5m):</strong></p>
<ul>
<li class=""><code>Kp = 200-400</code> (position gain)</li>
<li class=""><code>Kd = 40-80</code> (velocity gain)</li>
<li class=""><code>Ki = 5-15</code> (integral gain)</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="balance-recovery-strategies">Balance Recovery Strategies<a href="#balance-recovery-strategies" class="hash-link" aria-label="Direct link to Balance Recovery Strategies" title="Direct link to Balance Recovery Strategies" translate="no">​</a></h3>
<p><strong>1. Ankle Strategy (Small Perturbations)</strong></p>
<p><strong>When:</strong> Push force &lt;50N, <code>COM</code> stays within support polygon</p>
<p><strong>How:</strong> Adjust ankle torque to apply corrective moment</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Ankle_torque = -K_ankle * (theta - theta_desired)</span><br></span></code></pre></div></div>
<p><strong>Advantages:</strong></p>
<ul>
<li class="">Fast response (50-100ms)</li>
<li class="">Minimal energy</li>
<li class="">No foot movement</li>
</ul>
<p><strong>Limitations:</strong></p>
<ul>
<li class="">Small workspace (ankle ROM ±15°)</li>
<li class="">Cannot handle large disturbances</li>
</ul>
<p><strong>2. Hip Strategy (Medium Perturbations)</strong></p>
<p><strong>When:</strong> Push force 50-150N, <code>COM</code> approaching polygon edge</p>
<p><strong>How:</strong> Generate large angular momentum with hip motion</p>
<p><strong>Execution:</strong></p>
<ol>
<li class="">Detect <code>COM</code> near stability boundary</li>
<li class="">Swing hip opposite to disturbance</li>
<li class="">Generate counter-moment</li>
<li class="">Return to nominal posture</li>
</ol>
<p><strong>Advantages:</strong></p>
<ul>
<li class="">Larger workspace than ankle strategy</li>
<li class="">No stepping required</li>
</ul>
<p><strong>Limitations:</strong></p>
<ul>
<li class="">Slower than ankle (200-400ms)</li>
<li class="">Higher energy cost</li>
</ul>
<p><strong>3. Stepping Strategy (Large Perturbations)</strong></p>
<p><strong>When:</strong> Push force &gt;150N, <code>COM</code> exiting support polygon</p>
<p><strong>How:</strong> Take step to create new support polygon under <code>COM</code></p>
<p><strong>Capture Point Theory:</strong></p>
<ul>
<li class=""><strong>Capture point:</strong> Location where robot must step to stop <code>COM</code> motion</li>
<li class=""><strong>Formula:</strong> <code>x_capture = x_com + v_com / sqrt(g/z_com)</code></li>
</ul>
<p><strong>Execution:</strong></p>
<ol>
<li class="">Compute capture point</li>
<li class="">Plan foot placement at capture point</li>
<li class="">Execute rapid step (swing time &lt;0.3s)</li>
<li class="">Stabilize in new support</li>
</ol>
<p><strong>Recovery time:</strong> 0.5-1.5 seconds (meets SC-004 requirement)</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="whole-body-control">Whole-Body Control<a href="#whole-body-control" class="hash-link" aria-label="Direct link to Whole-Body Control" title="Direct link to Whole-Body Control" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="problem-formulation">Problem Formulation<a href="#problem-formulation" class="hash-link" aria-label="Direct link to Problem Formulation" title="Direct link to Problem Formulation" translate="no">​</a></h3>
<p><strong>Goal:</strong> Compute joint torques to achieve desired task-space motions (<code>COM</code>, feet, arms).</p>
<p><strong>Humanoid has:</strong></p>
<ul>
<li class="">n_q = 30-40 degrees of freedom (joints)</li>
<li class="">n_c = 6-12 contacts (feet on ground)</li>
<li class="">n_t = 12-18 task variables (<code>COM</code>, swing foot, arms)</li>
</ul>
<p><strong>Equations of motion:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">M(q) * q_ddot + C(q, q_dot) * q_dot + G(q) = τ + J_c^T * F_c</span><br></span></code></pre></div></div>
<p>Where:</p>
<ul>
<li class=""><code>M(q)</code> = inertia matrix</li>
<li class=""><code>C(q, q_dot)</code> = Coriolis/centrifugal matrix</li>
<li class=""><code>G(q)</code> = gravity vector</li>
<li class=""><code>τ</code> = joint torques (control input)</li>
<li class=""><code>J_c</code> = contact Jacobian</li>
<li class=""><code>F_c</code> = contact forces</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="quadratic-programming-qp-controller">Quadratic Programming (QP) Controller<a href="#quadratic-programming-qp-controller" class="hash-link" aria-label="Direct link to Quadratic Programming (QP) Controller" title="Direct link to Quadratic Programming (QP) Controller" translate="no">​</a></h3>
<p><strong>Formulate as optimization problem:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">minimize:  ||J * q_ddot - x_ddot_desired||² + λ * ||τ||²</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subject to:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    M(q) * q_ddot + h(q, q_dot) = τ + J_c^T * F_c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    F_c_min ≤ F_c ≤ F_c_max  (friction cone)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    τ_min ≤ τ ≤ τ_max        (joint limits)</span><br></span></code></pre></div></div>
<p><strong>Variables:</strong></p>
<ul>
<li class=""><code>q_ddot</code> = joint accelerations (n_q)</li>
<li class=""><code>τ</code> = joint torques (n_q)</li>
<li class=""><code>F_c</code> = contact forces (n_c)</li>
</ul>
<p><strong>Implementation:</strong> Use OSQP or quadprog solvers (10-20ms on CPU)</p>
<p>See <code>code-examples/locomotion/whole_body_controller.py</code> for complete QP formulation.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-hierarchy">Task Hierarchy<a href="#task-hierarchy" class="hash-link" aria-label="Direct link to Task Hierarchy" title="Direct link to Task Hierarchy" translate="no">​</a></h3>
<p><strong>Priority levels:</strong></p>
<ol>
<li class=""><strong>High priority:</strong> Balance (<code>COM</code> position/velocity)</li>
<li class=""><strong>Medium priority:</strong> Swing foot trajectory</li>
<li class=""><strong>Low priority:</strong> Arm posture</li>
</ol>
<p><strong>Hierarchical controller:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Solve QP with task prioritization</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">solve_wbc_hierarchical</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tasks</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> contacts</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Tasks sorted by priority (high → low)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tasks_sorted </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">sorted</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tasks</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key</span><span class="token operator" style="color:#393A34">=</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> t</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> t</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">priority</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> reverse</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Start with highest priority</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    qp_constraints </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">contacts</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> task </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> tasks_sorted</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Add task objective</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        qp_objective </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> task</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">jacobian @ q_ddot </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> task</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">desired_accel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Solve QP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        solution </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> solve_qp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">qp_objective</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> qp_constraints</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Add solution as constraint for next task (nullspace)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        qp_constraints</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">solution</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> solution</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="locomotion-on-uneven-terrain">Locomotion on Uneven Terrain<a href="#locomotion-on-uneven-terrain" class="hash-link" aria-label="Direct link to Locomotion on Uneven Terrain" title="Direct link to Locomotion on Uneven Terrain" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="terrain-sensing">Terrain Sensing<a href="#terrain-sensing" class="hash-link" aria-label="Direct link to Terrain Sensing" title="Direct link to Terrain Sensing" translate="no">​</a></h3>
<p><strong>Perception requirements:</strong></p>
<ul>
<li class="">Elevation map (height field)</li>
<li class="">Surface normals (slope estimation)</li>
<li class="">Obstacle detection (step height)</li>
<li class="">Friction coefficient estimation</li>
</ul>
<p><strong>Sources:</strong></p>
<ul>
<li class="">Point clouds (from Chapter 07)</li>
<li class="">Stereo depth</li>
<li class="">Heightmap from SLAM</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="adaptive-footstep-planning">Adaptive Footstep Planning<a href="#adaptive-footstep-planning" class="hash-link" aria-label="Direct link to Adaptive Footstep Planning" title="Direct link to Adaptive Footstep Planning" translate="no">​</a></h3>
<p><strong>Challenges on uneven terrain:</strong></p>
<ul>
<li class="">Support polygon is not flat</li>
<li class="">Foot orientation must match terrain</li>
<li class="">Step height varies</li>
<li class=""><code>COM</code> trajectory must account for elevation changes</li>
</ul>
<p><strong>Algorithm:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">plan_footstep_uneven</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">terrain_map</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> current_pose</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> target_velocity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Sample candidate foot positions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    candidates </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sample_foot_positions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">current_pose</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> target_velocity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Evaluate each candidate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    scores </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> candidate </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> candidates</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Check terrain height</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        height </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> terrain_map</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_height</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">candidate</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> candidate</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Check slope</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        normal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> terrain_map</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_normal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">candidate</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> candidate</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        slope </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> acos</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">normal</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Check obstacles</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        clear </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> terrain_map</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">is_collision_free</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">candidate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Score = weighted sum</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        score </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> w1 </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> slope</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">max_slope</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                w2 </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> clear </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                w3 </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> proximity_to_target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        scores</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Select best candidate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    best_footstep </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> candidates</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">argmax</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scores</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> best_footstep</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="balance-on-slopes">Balance on Slopes<a href="#balance-on-slopes" class="hash-link" aria-label="Direct link to Balance on Slopes" title="Direct link to Balance on Slopes" translate="no">​</a></h3>
<p><strong>ZMP on inclined terrain:</strong></p>
<ul>
<li class="">Support polygon rotates with terrain</li>
<li class="">Gravity projection changes</li>
<li class=""><code>COM</code> must shift to maintain ZMP inside polygon</li>
</ul>
<p><strong>Modified ZMP calculation:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">compute_zmp_on_slope</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">com_pos</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> com_accel</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> terrain_normal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Rotate gravity to terrain frame</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    g_rotated </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> rotate_vector</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">9.81</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> terrain_normal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># ZMP in terrain frame</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    zmp_x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> com_pos</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">com_pos</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">g_rotated</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> com_accel</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> com_accel</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    zmp_y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> com_pos</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">com_pos</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">g_rotated</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> com_accel</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> com_accel</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> zmp_x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> zmp_y</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="gait-state-machine">Gait State Machine<a href="#gait-state-machine" class="hash-link" aria-label="Direct link to Gait State Machine" title="Direct link to Gait State Machine" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="state-definitions">State Definitions<a href="#state-definitions" class="hash-link" aria-label="Direct link to State Definitions" title="Direct link to State Definitions" translate="no">​</a></h3>
<!-- -->
<p><strong>State transitions:</strong></p>
<ul>
<li class=""><strong>Idle → Standing:</strong> Activate joint position control, lift <code>COM</code></li>
<li class=""><strong>Standing → Walking:</strong> Start gait generator, first step</li>
<li class=""><strong>Walking → Running:</strong> Switch to dynamic walking (flight phase)</li>
<li class=""><strong>Walking → Balancing:</strong> Disturbance detected (IMU, force sensors)</li>
<li class=""><strong>Balancing → Walking:</strong> <code>COM</code> stabilized, return to nominal gait</li>
</ul>
<p><strong>Implementation:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">GaitStateMachine</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">state </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> GaitState</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">IDLE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transition_time </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.3</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># seconds</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">update</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sensors</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> commands</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">state </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> GaitState</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WALKING</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># Monitor balance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">detect_perturbation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sensors</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transition_to</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">GaitState</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">BALANCING</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># Check speed command</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> commands</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">velocity </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transition_to</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">GaitState</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RUNNING</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">state </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> GaitState</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">BALANCING</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># Attempt recovery</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">is_stable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sensors</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transition_to</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">GaitState</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WALKING</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># Timeout check</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">time_in_state</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.5</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transition_to</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">GaitState</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">FALLING</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="performance-metrics">Performance Metrics<a href="#performance-metrics" class="hash-link" aria-label="Direct link to Performance Metrics" title="Direct link to Performance Metrics" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="success-criteria">Success Criteria<a href="#success-criteria" class="hash-link" aria-label="Direct link to Success Criteria" title="Direct link to Success Criteria" translate="no">​</a></h3>
<p><strong>1. Walking Speed:</strong> 0.5 m/s on flat terrain (SC-004)</p>
<ul>
<li class="">Measured: Average <code>COM</code> velocity over 10 steps</li>
<li class="">Target: 0.45-0.55 m/s</li>
</ul>
<p><strong>2. Balance Recovery:</strong> Within 1.5 seconds from perturbation (SC-004)</p>
<ul>
<li class="">Test: Apply 100N lateral push</li>
<li class="">Measure: Time from push to stable <code>COM</code> (&lt; 5cm deviation)</li>
</ul>
<p><strong>3. Stability:</strong> No falls over 50 walking cycles</p>
<ul>
<li class="">Metric: Success rate &gt; 95%</li>
</ul>
<p><strong>4. Energy Efficiency:</strong> Cost of Transport (COT)</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">COT = Energy / (Weight * Distance)</span><br></span></code></pre></div></div>
<p>Target: COT &lt; 0.2 (comparable to human walking)</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="debugging-common-failures">Debugging Common Failures<a href="#debugging-common-failures" class="hash-link" aria-label="Direct link to Debugging Common Failures" title="Direct link to Debugging Common Failures" translate="no">​</a></h3>
<p><strong>1. Tipping Forward/Backward</strong></p>
<p><strong>Symptoms:</strong></p>
<ul>
<li class="">Robot falls in sagittal plane</li>
<li class="">Cannot recover balance</li>
</ul>
<p><strong>Causes:</strong></p>
<ul>
<li class="">ZMP reaching front/back edge of foot</li>
<li class=""><code>COM</code> moving too fast</li>
<li class="">Incorrect footstep timing</li>
</ul>
<p><strong>Solutions:</strong></p>
<ul>
<li class="">Reduce walking speed</li>
<li class="">Increase double support time</li>
<li class="">Tune ZMP margin (keep 2cm from edge)</li>
</ul>
<p><strong>2. Lateral Instability</strong></p>
<p><strong>Symptoms:</strong></p>
<ul>
<li class="">Swaying side-to-side</li>
<li class="">Eventually tips laterally</li>
</ul>
<p><strong>Causes:</strong></p>
<ul>
<li class="">Insufficient step width</li>
<li class=""><code>COM</code> not centered over support polygon</li>
<li class="">Hip joint compliance</li>
</ul>
<p><strong>Solutions:</strong></p>
<ul>
<li class="">Increase step width (0.1m → 0.15m)</li>
<li class="">Add lateral <code>COM</code> offset during single support</li>
<li class="">Increase hip joint stiffness</li>
</ul>
<p><strong>3. Foot Slip</strong></p>
<p><strong>Symptoms:</strong></p>
<ul>
<li class="">Foot slides on contact</li>
<li class="">Loss of balance</li>
<li class="">Jerky motion</li>
</ul>
<p><strong>Causes:</strong></p>
<ul>
<li class="">Excessive ground reaction forces</li>
<li class="">Low friction surface</li>
<li class="">Incorrect contact detection</li>
</ul>
<p><strong>Solutions:</strong></p>
<ul>
<li class="">Limit <code>COM</code> acceleration</li>
<li class="">Use rubber foot pads</li>
<li class="">Implement contact force sensing</li>
</ul>
<p><strong>4. Oscillations (Limit Cycles)</strong></p>
<p><strong>Symptoms:</strong></p>
<ul>
<li class="">Robot bounces/oscillates</li>
<li class="">Cannot settle to stable gait</li>
</ul>
<p><strong>Causes:</strong></p>
<ul>
<li class="">PID gains too high</li>
<li class="">Coupling between <code>COM</code> and swing foot controllers</li>
<li class="">Unmodeled leg dynamics</li>
</ul>
<p><strong>Solutions:</strong></p>
<ul>
<li class="">Reduce Kd gain (damping)</li>
<li class="">Add low-pass filter on control output</li>
<li class="">Increase simulation timestep resolution</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="integration-with-perception-and-manipulation">Integration with Perception and Manipulation<a href="#integration-with-perception-and-manipulation" class="hash-link" aria-label="Direct link to Integration with Perception and Manipulation" title="Direct link to Integration with Perception and Manipulation" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="perception-guided-walking">Perception-Guided Walking<a href="#perception-guided-walking" class="hash-link" aria-label="Direct link to Perception-Guided Walking" title="Direct link to Perception-Guided Walking" translate="no">​</a></h3>
<p><strong>Use case:</strong> Navigate to table while avoiding obstacles</p>
<p><strong>Pipeline:</strong></p>
<ol>
<li class=""><strong>Perception:</strong> Generate occupancy grid from point cloud</li>
<li class=""><strong>Path planning:</strong> A* or RRT to find collision-free path</li>
<li class=""><strong>Footstep planning:</strong> Place feet along path, respecting obstacles</li>
<li class=""><strong>Gait execution:</strong> Walk along planned footsteps</li>
</ol>
<p><strong>Code example:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Perception provides obstacles</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">obstacles </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> perception_module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_obstacles</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Plan path to goal</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">path </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> path_planner</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plan</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">robot_pose</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> goal_pose</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> obstacles</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Convert path to footsteps</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">footsteps </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> footstep_planner</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">generate_from_path</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Execute gait</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gait_controller</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute_footsteps</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">footsteps</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="manipulation-while-walking">Manipulation While Walking<a href="#manipulation-while-walking" class="hash-link" aria-label="Direct link to Manipulation While Walking" title="Direct link to Manipulation While Walking" translate="no">​</a></h3>
<p><strong>Challenges:</strong></p>
<ul>
<li class="">Arm motion affects <code>COM</code> (dynamic coupling)</li>
<li class="">Reduced stability margin (arms not available for balance)</li>
<li class="">Coordination of locomotion and manipulation timing</li>
</ul>
<p><strong>Whole-body coordination:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">walk_and_manipulate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">walk_trajectory</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> arm_trajectory</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Compute combined COM accounting for arm mass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    com_total </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">m_body </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> com_body </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> m_arm </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> com_arm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">m_body </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> m_arm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Adjust ZMP reference to account for arm motion</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    zmp_adjusted </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> zmp_nominal </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> K_arm </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arm_accel </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> arm_accel_planned</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Solve whole-body QP with both tasks</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tasks </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Task</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">type</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;COM&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> jacobian</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">J_com</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> priority</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Task</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">type</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;FOOT&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> jacobian</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">J_foot</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> priority</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Task</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">type</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;ARM&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> jacobian</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">J_arm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> priority</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    torques </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> whole_body_controller</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">solve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tasks</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> torques</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="further-reading">Further Reading<a href="#further-reading" class="hash-link" aria-label="Direct link to Further Reading" title="Direct link to Further Reading" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="research-papers">Research Papers<a href="#research-papers" class="hash-link" aria-label="Direct link to Research Papers" title="Direct link to Research Papers" translate="no">​</a></h3>
<ol>
<li class=""><strong>Preview Control of ZMP</strong> (Kajita et al. 2003) - <a href="https://ieeexplore.ieee.org/document/1241826" target="_blank" rel="noopener noreferrer" class="">IEEE Xplore</a>
<ul>
<li class="">Foundational ZMP-based gait generation</li>
</ul>
</li>
<li class=""><strong>Capture Point</strong> (Pratt &amp; Tedrake 2006) - <a href="https://groups.csail.mit.edu/robotics-center/public_papers/Pratt06.pdf" target="_blank" rel="noopener noreferrer" class="">Paper</a>
<ul>
<li class="">Balance recovery using capture point theory</li>
</ul>
</li>
<li class=""><strong>Whole-Body Control</strong> (Sentis &amp; Khatib 2005) - <a href="https://journals.sagepub.com/doi/10.1177/0278364905050805" target="_blank" rel="noopener noreferrer" class="">IJRR</a>
<ul>
<li class="">Task-space control with contact constraints</li>
</ul>
</li>
<li class=""><strong>Terrain-Aware Footstep Planning</strong> (Deits &amp; Tedrake 2014) - <a href="https://groups.csail.mit.edu/robotics-center/public_papers/Deits14.pdf" target="_blank" rel="noopener noreferrer" class="">Paper</a>
<ul>
<li class="">Mixed-integer optimization for footstep planning</li>
</ul>
</li>
<li class=""><strong>ATLAS Robot</strong> (Kuindersma et al. 2016) - <a href="https://robotics.sciencemag.org/content/1/1/eaah3857" target="_blank" rel="noopener noreferrer" class="">Science Robotics</a>
<ul>
<li class="">Real-world humanoid locomotion on rough terrain</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="open-source-libraries">Open-Source Libraries<a href="#open-source-libraries" class="hash-link" aria-label="Direct link to Open-Source Libraries" title="Direct link to Open-Source Libraries" translate="no">​</a></h3>
<ul>
<li class=""><strong>Humanoid Control:</strong> <a href="https://github.com/stack-of-tasks/pinocchio" target="_blank" rel="noopener noreferrer" class="">Pinocchio</a></li>
<li class=""><strong>QP Solver (OSQP):</strong> <a href="https://github.com/osqp/osqp" target="_blank" rel="noopener noreferrer" class="">OSQP</a></li>
<li class=""><strong>Gait Planning:</strong> <a href="https://github.com/stephane-caron/pymanoid" target="_blank" rel="noopener noreferrer" class="">Pymanoid</a></li>
<li class=""><strong>Whole-Body Control:</strong> <a href="https://github.com/stack-of-tasks/tsid" target="_blank" rel="noopener noreferrer" class="">TSID</a></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="ros-2-packages">ROS 2 Packages<a href="#ros-2-packages" class="hash-link" aria-label="Direct link to ROS 2 Packages" title="Direct link to ROS 2 Packages" translate="no">​</a></h3>
<ul>
<li class=""><strong>Humanoid Common Msgs:</strong> <a href="https://github.com/ros-naoqi/humanoid_msgs" target="_blank" rel="noopener noreferrer" class="">humanoid_msgs</a></li>
<li class=""><strong>Walking Controller:</strong> <a href="https://github.com/pal-robotics/talos_walking" target="_blank" rel="noopener noreferrer" class="">talos_walking</a></li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary" translate="no">​</a></h2>
<p>In this chapter, you learned:</p>
<ul>
<li class="">✅ <strong>Gait generation</strong> using ZMP-based trajectory planning</li>
<li class="">✅ <strong>Balance control</strong> with <code>COM</code> stabilization and recovery strategies</li>
<li class="">✅ <strong>Whole-body control</strong> using quadratic programming</li>
<li class="">✅ <strong>Locomotion on uneven terrain</strong> with adaptive footstep planning</li>
<li class="">✅ <strong>Gait state machines</strong> for robust mode transitions</li>
<li class="">✅ <strong>Performance metrics</strong> for walking speed and balance recovery</li>
<li class="">✅ <strong>Debugging strategies</strong> for common locomotion failures</li>
<li class="">✅ <strong>Integration</strong> with perception and manipulation systems</li>
</ul>
<p><strong>Next steps:</strong></p>
<ul>
<li class=""><strong>Chapter 09:</strong> Dexterous Manipulation (grasp planning, IK, force control)</li>
<li class=""><strong>Chapter 13:</strong> Capstone Project (integrate locomotion + perception + manipulation)</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Practical Exercise</div><div class="admonitionContent_BuS1"><p><strong>Implement stable walking in Isaac Sim:</strong></p><ol>
<li class="">Create humanoid URDF with 12-DOF legs</li>
<li class="">Implement ZMP-based gait generator</li>
<li class="">Add <code>COM</code> balance controller (PID)</li>
<li class="">Test walking at 0.5 m/s on flat terrain</li>
<li class="">Apply lateral push (100N) and verify recovery &lt; 1.5s</li>
<li class="">Measure energy efficiency (Cost of Transport)</li>
</ol><p><strong>Time estimate:</strong> 4-6 hours
<strong>Difficulty:</strong> Advanced
<strong>Prerequisites:</strong> Control theory, dynamics, Isaac Sim</p></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/MuhammadWaqasrafiq/HumanoidRoboticsBook/tree/main/docs/bipedal-locomotion/index.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/HumanoidRoboticsBook/docs/perception-stack"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">07. Perception Stack</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/HumanoidRoboticsBook/docs/dexterous-manipulation"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">09. Dexterous Manipulation</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-youll-learn" class="table-of-contents__link toc-highlight">What You&#39;ll Learn</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#why-bipedal-locomotion-is-hard" class="table-of-contents__link toc-highlight">Why Bipedal Locomotion is Hard</a></li><li><a href="#gait-generation-fundamentals" class="table-of-contents__link toc-highlight">Gait Generation Fundamentals</a><ul><li><a href="#walking-cycle-phases" class="table-of-contents__link toc-highlight">Walking Cycle Phases</a></li><li><a href="#zero-moment-point-zmp-theory" class="table-of-contents__link toc-highlight">Zero Moment Point (ZMP) Theory</a></li><li><a href="#zmp-based-gait-planning" class="table-of-contents__link toc-highlight">ZMP-Based Gait Planning</a></li><li><a href="#gait-generator-implementation" class="table-of-contents__link toc-highlight">Gait Generator Implementation</a></li></ul></li><li><a href="#balance-control" class="table-of-contents__link toc-highlight">Balance Control</a><ul><li><a href="#center-of-mass-com-stabilization" class="table-of-contents__link toc-highlight">Center of Mass (<code>COM</code>) Stabilization</a></li><li><a href="#balance-recovery-strategies" class="table-of-contents__link toc-highlight">Balance Recovery Strategies</a></li></ul></li><li><a href="#whole-body-control" class="table-of-contents__link toc-highlight">Whole-Body Control</a><ul><li><a href="#problem-formulation" class="table-of-contents__link toc-highlight">Problem Formulation</a></li><li><a href="#quadratic-programming-qp-controller" class="table-of-contents__link toc-highlight">Quadratic Programming (QP) Controller</a></li><li><a href="#task-hierarchy" class="table-of-contents__link toc-highlight">Task Hierarchy</a></li></ul></li><li><a href="#locomotion-on-uneven-terrain" class="table-of-contents__link toc-highlight">Locomotion on Uneven Terrain</a><ul><li><a href="#terrain-sensing" class="table-of-contents__link toc-highlight">Terrain Sensing</a></li><li><a href="#adaptive-footstep-planning" class="table-of-contents__link toc-highlight">Adaptive Footstep Planning</a></li><li><a href="#balance-on-slopes" class="table-of-contents__link toc-highlight">Balance on Slopes</a></li></ul></li><li><a href="#gait-state-machine" class="table-of-contents__link toc-highlight">Gait State Machine</a><ul><li><a href="#state-definitions" class="table-of-contents__link toc-highlight">State Definitions</a></li></ul></li><li><a href="#performance-metrics" class="table-of-contents__link toc-highlight">Performance Metrics</a><ul><li><a href="#success-criteria" class="table-of-contents__link toc-highlight">Success Criteria</a></li><li><a href="#debugging-common-failures" class="table-of-contents__link toc-highlight">Debugging Common Failures</a></li></ul></li><li><a href="#integration-with-perception-and-manipulation" class="table-of-contents__link toc-highlight">Integration with Perception and Manipulation</a><ul><li><a href="#perception-guided-walking" class="table-of-contents__link toc-highlight">Perception-Guided Walking</a></li><li><a href="#manipulation-while-walking" class="table-of-contents__link toc-highlight">Manipulation While Walking</a></li></ul></li><li><a href="#further-reading" class="table-of-contents__link toc-highlight">Further Reading</a><ul><li><a href="#research-papers" class="table-of-contents__link toc-highlight">Research Papers</a></li><li><a href="#open-source-libraries" class="table-of-contents__link toc-highlight">Open-Source Libraries</a></li><li><a href="#ros-2-packages" class="table-of-contents__link toc-highlight">ROS 2 Packages</a></li></ul></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Learn</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/HumanoidRoboticsBook/docs/intro">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/HumanoidRoboticsBook/docs/why-physical-ai">Why Physical AI</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/MuhammadWaqasrafiq/HumanoidRoboticsBook" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Repo<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/MuhammadWaqasrafiq/HumanoidRoboticsBook/tree/main/code-examples" target="_blank" rel="noopener noreferrer" class="footer__link-item">Code Samples<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Connect</div><ul class="footer__items clean-list"><li class="footer__item">
<div style="display:flex; gap:1.5rem; margin-bottom:1rem;">
  <a href="https://github.com/MuhammadWaqasrafiq/HumanoidRoboticsBook" target="_blank" rel="noopener noreferrer" aria-label="GitHub" style="color:#fff;font-size:1.6rem;">
    <i class="fa-brands fa-github"></i>
  </a>
  <a href="https://linkedin.com/in/MuhammadWaqasrafiq" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn" style="color:#fff;font-size:1.6rem;">
    <i class="fa-brands fa-linkedin"></i>
  </a>
  <a href="https://wa.me/923463033195" target="_blank" rel="noopener noreferrer" aria-label="WhatsApp" style="color:#fff;font-size:1.6rem;">
    <i class="fa-brands fa-whatsapp"></i>
  </a>
  <a href="https://www.youtube.com/watch?v=dZTfXiPSZyE" target="_blank" rel="noopener noreferrer" aria-label="YouTube" style="color:#fff;font-size:1.6rem;">
    <i class="fa-brands fa-youtube"></i>
  </a>
</div>
              </li><li class="footer__item"><a href="https://github.com/MuhammadWaqasrafiq/HumanoidRoboticsBook/blob/main/LICENSE" target="_blank" rel="noopener noreferrer" class="footer__link-item">MIT License<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2025 Embodied AI • Muhammad Waqas Rafiq • MIT & CC-BY-4.0</div></div></div></footer></div>
</body>
</html>